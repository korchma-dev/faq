<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAQ Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #ffe6f2;
            margin: 0;
            padding: 0;
            color: #333;
        }

        .faq-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .faq-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .lang-switch {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 10px;
        }

        .faq-title {
            text-align: center;
            color: #ff4d88;
            margin-bottom: 20px;
        }

        .lang-switch button {
            padding: 5px 10px;
            background: #ff4d88;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .lang-switch button:hover {
            background: #e6005c;
        }

        .faq-item {
            margin-bottom: 10px;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #ff99c2;
            position: relative;
        }

        .faq-question {
            padding: 15px;
            background: #ff4d88;
            color: white;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s, box-shadow 0.3s;
            border-radius: 10px;
        }

        .faq-question:hover {
            background: #e6005c;
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            background: #ffe6f2;
            color: #333;
            padding: 0;
            transition: max-height 0.5s ease, padding 0.3s ease;
        }

        .faq-answer.open {
            max-height: 10000px;
            padding: 15px;
        }

        .faq-answer img {
            width: 100%;
            height: auto;
            margin: 15px 0;
            border-radius: 10px;
        }

        .faq-answer p {
            margin: 10px 0;
            line-height: 1.5;
        }

        .faq-icon {
            transform: rotate(0deg);
            transition: transform 0.3s;
        }

        .faq-icon.open {
            transform: rotate(180deg);
        }

        .nested-container {
            margin-left: 20px;
            border-left: 2px solid #ff99c2;
            padding-left: 10px;
        }

        .nested-question {
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
            color: #ff4d88;
        }

        .nested-answer {
            display: none;
        }

        .nested-answer.open {
            display: block;
        }

        .faq-question.sticky {
            position: fixed;
            top: 10px;
            left: auto;
            right: auto;
            background: #ff4d88;
            z-index: 1000;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: calc(100% - 40px);
            max-width: 760px;
            margin: 0 auto;
        }
    </style>
</head>
<body>

<div class="faq-container">
    <div class="lang-switch">
        <button data-lang="en">üá∫üá∏ English</button>
        <button data-lang="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</button>
    </div>
    <h1 class="faq-title">FAQ Documentation</h1>

    <div class="faq-items"></div>

</div>

<script>
    let currentLang = 'en';

    function loadTexts(lang) {
        fetch(`lang/${lang}.json`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Failed to load language file: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                document.querySelector('.faq-title').textContent = data.title;
                const faqContainer = document.querySelector('.faq-items');
                faqContainer.innerHTML = '';

                data.faqs.forEach((faq, index) => {
                    const faqItem = document.createElement('div');
                    faqItem.className = 'faq-item';
                    faqItem.id = `faq${index + 1}`; 

                    faqItem.innerHTML = `
                        <div class="faq-question">
                            <span>${faq.question}</span>
                            <span class="faq-icon">&#9660;</span>
                        </div>
                        <div class="faq-answer"></div>
                    `;

                    const answer = faqItem.querySelector('.faq-answer');
                    renderContent(answer, faq.content);
                    faqContainer.appendChild(faqItem);

                    const question = faqItem.querySelector('.faq-question');
                    const icon = faqItem.querySelector('.faq-icon');
                    question.addEventListener('click', () => {
                        document.querySelectorAll('.faq-answer.open').forEach(openAnswer => {
                            if (openAnswer !== answer) {
                                openAnswer.classList.remove('open');
                                openAnswer.previousElementSibling.querySelector('.faq-icon').classList.remove('open');
                            }
                        });

                        answer.classList.toggle('open');
                        icon.classList.toggle('open');
                    });
                });

                const urlParams = new URLSearchParams(window.location.search);
                const faqToOpen = urlParams.get('faq');
                if (faqToOpen) {
                    const faqElement = document.getElementById(faqToOpen);
                    if (faqElement) {
                        const question = faqElement.querySelector('.faq-question');
                        const answer = faqElement.querySelector('.faq-answer');
                        const icon = faqElement.querySelector('.faq-icon');

                        answer.classList.add('open');
                        icon.classList.add('open');

                        setTimeout(() => {
                            faqElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }, 100);
                    }
                }
            })
            .catch(error => console.error('Error loading texts:', error));
    }

    function renderContent(container, content) {
        content.forEach(item => {
            if (item.type === 'text') {
                const paragraph = document.createElement('p');
                paragraph.textContent = item.value;
                container.appendChild(paragraph);
            } else if (item.type === 'image') {
                const image = document.createElement('img');
                image.src = item.src;
                image.alt = item.alt || 'Image';
                container.appendChild(image);
            } else if (item.type === 'nested') {
                item.subquestions.forEach(sub => {
                    const nestedContainer = document.createElement('div');
                    nestedContainer.classList.add('nested-container');

                    const nestedQuestion = document.createElement('div');
                    nestedQuestion.classList.add('nested-question');
                    nestedQuestion.textContent = sub.subquestion;

                    const nestedAnswer = document.createElement('div');
                    nestedAnswer.classList.add('nested-answer');
                    renderContent(nestedAnswer, sub.content);

                    nestedContainer.appendChild(nestedQuestion);
                    nestedContainer.appendChild(nestedAnswer);
                    container.appendChild(nestedContainer);

                    nestedQuestion.addEventListener('click', () => {
                        nestedAnswer.classList.toggle('open');
                    });
                });
            }
        });
    }

    document.querySelectorAll('.lang-switch button').forEach(button => {
        button.addEventListener('click', function () {
            const lang = this.getAttribute('data-lang');
            currentLang = lang;
            loadTexts(lang);
        });
    });

    loadTexts(currentLang);
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.faq-item').forEach(faqItem => {
        const question = faqItem.querySelector('.faq-question');
        const answer = faqItem.querySelector('.faq-answer');
        const icon = question.querySelector('.faq-icon');

        let isSticky = false; // State of stickiness

        // Toggle open/close functionality
        question.addEventListener('click', () => {
            const isOpen = answer.classList.contains('open');

            // Reset all open answers
            document.querySelectorAll('.faq-answer.open').forEach(a => a.classList.remove('open'));
            document.querySelectorAll('.faq-icon.open').forEach(i => i.classList.remove('open'));

            if (!isOpen) {
                answer.classList.add('open');
                icon.classList.add('open');
                faqItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else {
                answer.classList.remove('open');
                icon.classList.remove('open');
                question.classList.remove('sticky'); // Remove stickiness when closed
            }
        });

        // Sticky header functionality
        window.addEventListener('scroll', () => {
            const rect = faqItem.getBoundingClientRect();
            const questionRect = question.getBoundingClientRect();
            const offset = 10; // Offset from the top of the screen

            if (rect.top <= offset && rect.bottom > questionRect.height && answer.classList.contains('open')) {
                if (!isSticky) {
                    // Set sticky styles
                    const faqWidth = faqItem.offsetWidth; // Match parent width
                    const faqLeft = faqItem.getBoundingClientRect().left; // Match parent left position

                    question.style.width = `${faqWidth}px`;
                    question.style.left = `${faqLeft}px`;
                    question.style.top = `${offset}px`;

                    question.classList.add('sticky');
                    isSticky = true;
                }
            } else {
                if (isSticky) {
                    // Remove sticky styles
                    question.classList.remove('sticky');
                    question.style.width = '';
                    question.style.left = '';
                    question.style.top = '';
                    isSticky = false;
                }
            }
        });
    });
});

</script>

</body>
</html>
